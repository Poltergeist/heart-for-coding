function dc(ctx, x, y, s){
  return function(){
    s = s || 10
    mt(x,y);
    lt(x+s,y-s);
    lt(x+(s*2),y);
    lt(x+(s * 2),y);
    lt(x+(s * 2),y+s);
    lt(x+s,y+(s * 2));
    lt(x,y+s);
    ctx.fill();
  }
}
function dh(ctx, x, y, s, first, last){
  if (!first) {
    st(dc(ctx, x+(s / 2), y-(s / 2), (s / 2)), 0);
  } else {
    st(dc(ctx, x, y, s), 0);
  }
  st(dc(ctx, x+s, y+s, s), 200);
  st(dc(ctx, x+(s*2), y, s), 400);
  st(d3D(ctx, x, y, s), 400);
  st(next, 600);

}
function d3D(ctx, x, y, s){
  return function(){
    mt(x,y);
    lt(x, y+s);
    lt(x+(s*2),y+(s*3));
    lt(x+(s*4),y+s);
    lt(x+(s*4),y);
    ctx.fill();
  }

}
function resCanvas() {
  c.width = wi;
  c.height = ht;

}
function d(runs, start){
  m = ma.pow(2, runs) || 64;
  x = (wi / 2) - (m * 2);
  y = (ht / 2) - (m);

  x = ma.random() * wi;
  y = ma.random() * ht;
  ctx.closePath();
  ctx.beginPath();
  ctx.fillStyle = '#' + (ma.ceil(ma.random()*16777215)).toString(16);
  dh(ctx, x, y, s, true);
  s += s;

}
function next(){
  if (s <= m) {
    dh(ctx, x, y, s, false, s >= m);
    s += s ;
    return;
  }
  s = 1;
  st(function(){d(7);},2000);

}
var c = document.getElementById('C'),
  w = window,
  ctx=c.getContext('2d'),
  lt = function(x, y){
    ctx.lineTo(x, y);
  },
  mt = function(x, y){
    ctx.moveTo(x, y);
  },
  st = w.setTimeout,
  s = 1,
  wi = w.innerWidth,
  ht = w.innerHeight,
  ma = Math,
  m, x, y;
resCanvas();
next();
//d(7);
